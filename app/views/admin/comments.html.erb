<% content_for :sidebar do %>
<%=  render :partial => 'shared/admin_nav' %>

<%=  rounded_box :div_class => 'white-fg bluegray-bg' do %>
<%=  form_for @search, :html => {:class => "MainForm"} do |f| %>
<%=  f.label :commentable_type.l %>

<%=  f.text_field :commentable_type_like %>

<%= f.label :commentable_id.l %>

<%= f.text_field :commentable_id %>

<%= f.label :email.l %>

<%= f.text_field :author_email_or_user_email_like %>

<p><%= f.submit :search.l %>
</p>
<% end %>

<% end %>

<% end %>
<%=  form_tag delete_selected_comments_path, :id => 'comments' do %>
<%=  rounded_box :div_class => 'white-fg bluegray-bg' do %>
<div class='right'>
  <% if @comments.any? %>
  <a href="#" onclick="checkboxes.each(function(e){ e.checked = (e.checked == 0 ? 1 : 0) }); return false;">Toggle all</a>

    <%=  submit_tag :delete_selected.l %>

  <% end %>
</div>
<h3>
    <%=  AppConfig.community_name %>

    <%=  :comments.l %>

</h3>
<% if @comments.total_pages > 1 %>
<div class='pagination'><%= paginating_links @comments, :link_to_current_page => true %>
</div>
<% end %>
<table border='0' cellpadding='0' cellspacing='0' style='table-layout:fixed;' width='100%'>
  <thead>
    <tr>
      <th colspan='2' width='30px'></th>
      <th>      <%= :author.l %>
</th>
      <th width='250px'>      <%= :body_text.l %>
</th>
      <th>      <%= :on_commentable.l %>
</th>
    </tr>
  </thead>
  <tbody>
    <%  @comments.each do |comment| %>
    <tr id="comment_<%= comment.id %>">

      <td>      <%= link_to(image_tag('icons/delete.png'), {:remote => true, :url => comment_path(comment.commentable_type, comment.commentable_id, comment), :method => :delete, 500 => 'alert(\'Sorry, there was a server error\'); return false', :success => visual_effect(:fade, "comment_#{comment.id}"), :confirm => "Are you sure you want to permanently delete this comment"} ) %>
</td>
      <td>      <%= check_box_tag "delete[]", comment.id %>
</td>
      <td>
        <div class='left'>
          <% if comment.user %>
                    <%=  link_to h(comment.user.login), user_path(comment.user) %>

          <br />
          <small>          <%= comment.user.email %>
</small>
          <% else %>
                    <%=  link_to_unless(comment.author_url.blank?, h(comment.username), h(comment.author_url)){ h(comment.username) } %>

          <br />
          <small>          <%= comment.author_email %>
</small>
          <br />
          <small>          <%= "(#{comment.author_url})" %>
</small>
          <% end %>
        </div>
      </td>
      <td style='overflow:hidden;'>
                <%=  comment.comment %>

      </td>
      <td>
                <%= link_to comment.commentable_name, commentable_url(comment) %>

      </td>
    </tr>
    <% end %>
  </tbody>
</table>
<div class='right'>
  <% if @comments.any? %>
  <a href="#" onclick="checkboxes.each(function(e){ e.checked = (e.checked == 0 ? 1 : 0) }); return false;">Toggle all</a>

    <%=  submit_tag :delete_selected.l %>

  <% end %>
</div>
<div class='clear'></div>
<% if @comments.total_pages > 1 %>
<div class='pagination'><%= paginating_links @comments, :link_to_current_page => true %>
</div>
<% end %>
<% end %>

<% end %>

<script type='text/javascript'>
  var form = $('comments');
  checkboxes = form.getInputs('checkbox');
</script>
